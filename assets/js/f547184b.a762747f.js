"use strict";(self.webpackChunkls_fusion_docs=self.webpackChunkls_fusion_docs||[]).push([[67146],{73763:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>r,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var t=n(74848),l=n(28453);const a={title:"How-to: GROUP LAST"},s=void 0,i={id:"How-to_GROUP_LAST",title:"How-to: GROUP LAST",description:"Example 1",source:"@site/docs/How-to_GROUP_LAST.md",sourceDirName:".",slug:"/How-to_GROUP_LAST",permalink:"/next/How-to_GROUP_LAST",draft:!1,unlisted:!1,editUrl:"https://github.com/lsfusion/platform/edit/master/docs/en/How-to_GROUP_LAST.md",tags:[],version:"current",lastUpdatedAt:1622042248e3,frontMatter:{title:"How-to: GROUP LAST"},sidebar:"learn",previous:{title:"How-to: CASE/IF/OVERRIDE",permalink:"/next/How-to_CASE_IF_OVERRIDE"},next:{title:"How-to: GROUP CONCAT",permalink:"/next/How-to_GROUP_CONCAT"}},r={},c=[{value:"Example 1",id:"example-1",level:2},{value:"Task",id:"task",level:3},{value:"Solution",id:"solution",level:3},{value:"Example 2",id:"example-2",level:2},{value:"Task",id:"task-1",level:3},{value:"Solution",id:"solution-1",level:3},{value:"Example 3",id:"example-3",level:2},{value:"Task",id:"task-2",level:3},{value:"Solution",id:"solution-2",level:3},{value:"Example 4",id:"example-4",level:2},{value:"Task",id:"task-3",level:3},{value:"Solution",id:"solution-3",level:3},{value:"Example 5",id:"example-5",level:2},{value:"Task",id:"task-4",level:3},{value:"Solution",id:"solution-4",level:3}];function d(e){const o={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.h2,{id:"example-1",children:"Example 1"}),"\n",(0,t.jsx)(o.h3,{id:"task",children:"Task"}),"\n",(0,t.jsx)(o.p,{children:"We have a set of books associated with a certain category, and the dates of their receipt."}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-lsf",children:"CLASS Book 'Book';\nCLASS Category 'Category';\n\ncategory 'Category' = DATA Category (Book);\ndate 'Arrival date' = DATA DATE (Book);\n"})}),"\n",(0,t.jsx)(o.p,{children:"We need to find the latest received book in the selected category."}),"\n",(0,t.jsx)(o.h3,{id:"solution",children:"Solution"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-lsf",children:"book 'Last book' (Category c) = GROUP LAST Book b ORDER date(b), b BY category(b);\n"})}),"\n",(0,t.jsxs)(o.p,{children:["It is important to remember that order in the ",(0,t.jsx)(o.code,{children:"ORDER"})," clause should be uniquely determined. To do this, the book (specifically, its internal ID) should be used as the second parameter since several books may have the same date of receipt."]}),"\n",(0,t.jsx)(o.h2,{id:"example-2",children:"Example 2"}),"\n",(0,t.jsx)(o.h3,{id:"task-1",children:"Task"}),"\n",(0,t.jsxs)(o.p,{children:["Similar to ",(0,t.jsx)(o.a,{href:"#example-1",children:(0,t.jsx)(o.strong,{children:"Example 1"})}),", but the author and genre list are specified for each book."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-lsf",children:"CLASS Author 'Author';\nCLASS Genre 'Genre';\n\nauthor 'Author' = DATA Author (Book);\ngenre 'Genre' = DATA Genre (Book);\nin 'On' = DATA BOOLEAN (Book, Genre);\n"})}),"\n",(0,t.jsx)(o.p,{children:"We need to find the most popular category by author and genre."}),"\n",(0,t.jsx)(o.h3,{id:"solution-1",children:"Solution"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-lsf",children:"countBooks 'Number of books' (Category c, Author a, Genre g) = GROUP SUM 1 IF in(Book b, g) BY category(b), author(b);\n\ncategory (Author a, Genre g) = GROUP LAST Category c ORDER countBooks(c, a, g), c WHERE countBooks(c, a, g);\n"})}),"\n",(0,t.jsx)(o.h2,{id:"example-3",children:"Example 3"}),"\n",(0,t.jsx)(o.h3,{id:"task-2",children:"Task"}),"\n",(0,t.jsxs)(o.p,{children:["We have a certain set of books and the information about price changes per book and warehouse. Each object of the ",(0,t.jsx)(o.code,{children:"Ledger"})," class reflects a single change in price since a specific date."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-lsf",children:"CLASS Stock 'Warehouse';\n\nCLASS Ledger 'Price change';\ndate = DATA DATE (Ledger);\nstock = DATA Stock (Ledger);\nbook = DATA Book (Ledger);\n\nprice = DATA NUMERIC[10,2] (Ledger);\n"})}),"\n",(0,t.jsx)(o.p,{children:"We need to identify the current price for a given book at the warehouse."}),"\n",(0,t.jsx)(o.h3,{id:"solution-2",children:"Solution"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-lsf",children:"currentPrice (Book b, Stock s) = GROUP LAST price(Ledger l) ORDER date(l), l BY book(l), stock(l);//#solution3\n"})}),"\n",(0,t.jsx)(o.h2,{id:"example-4",children:"Example 4"}),"\n",(0,t.jsx)(o.h3,{id:"task-3",children:"Task"}),"\n",(0,t.jsxs)(o.p,{children:["Similar to ",(0,t.jsx)(o.a,{href:"#example-3",children:(0,t.jsx)(o.strong,{children:"Example 3"})}),"."]}),"\n",(0,t.jsx)(o.p,{children:"We need to find the price valid for a specific date for a book at the warehouse."}),"\n",(0,t.jsx)(o.h3,{id:"solution-3",children:"Solution"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-lsf",children:"price (Book b, Stock s, DATE d) = GROUP LAST price(Ledger l) ORDER date(l), l WHERE date(l) <= d BY book(l), stock(l);\n"})}),"\n",(0,t.jsx)(o.h2,{id:"example-5",children:"Example 5"}),"\n",(0,t.jsx)(o.h3,{id:"task-4",children:"Task"}),"\n",(0,t.jsxs)(o.p,{children:["Similar to ",(0,t.jsx)(o.a,{href:"#example-4",children:(0,t.jsx)(o.strong,{children:"Example 4"})}),", except that a change in price has an expiration date. If this date is not specified, then the price is not limited in time."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-lsf",children:"dateTo 'Valid until (inclusive)' = DATA DATE (Ledger);\n"})}),"\n",(0,t.jsx)(o.h3,{id:"solution-4",children:"Solution"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-lsf",children:"currentPriceDate (Book b, Stock s) = GROUP LAST price(Ledger l) ORDER date(l), l WHERE NOT dateTo(l) < currentDate() BY book(l), stock(l);\npriceDate(Book b, Stock s, DATE d) = GROUP LAST price(Ledger l) ORDER date(l), l WHERE date(l) <= d AND NOT dateTo(l) < d BY book(l), stock(l);\n"})}),"\n",(0,t.jsxs)(o.p,{children:["Note that the expression ",(0,t.jsx)(o.code,{children:"NOT dateTo(l) < date"})," does not always mean the same as ",(0,t.jsx)(o.code,{children:"dateTo(l) >= date"}),". The difference occurs when the value ",(0,t.jsx)(o.code,{children:"dateTo(l)"})," equals ",(0,t.jsx)(o.code,{children:"NULL"}),". In the first case, ",(0,t.jsx)(o.code,{children:"dateTo(l) < date"})," equals ",(0,t.jsx)(o.code,{children:"NULL"})," (i. e. false), while ",(0,t.jsx)(o.code,{children:"NOT NULL"})," equals ",(0,t.jsx)(o.code,{children:"TRUE"}),". In the second case, the expression obviously equals ",(0,t.jsx)(o.code,{children:"NULL"})," (i. e. false)."]})]})}function h(e={}){const{wrapper:o}={...(0,l.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,o,n)=>{n.d(o,{R:()=>s,x:()=>i});var t=n(96540);const l={},a=t.createContext(l);function s(e){const o=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function i(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),t.createElement(a.Provider,{value:o},e.children)}}}]);
"use strict";(self.webpackChunkls_fusion_docs=self.webpackChunkls_fusion_docs||[]).push([[45325],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||i;return n?a.createElement(h,o(o({ref:t},p),{},{components:n})):a.createElement(h,o({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},87614:function(e,t,n){n.r(t),n.d(t,{assets:function(){return l},contentTitle:function(){return o},default:function(){return u},frontMatter:function(){return i},metadata:function(){return s},toc:function(){return c}});var a=n(83117),r=(n(67294),n(3905));const i={title:"Constraints"},o=void 0,s={unversionedId:"Constraints",id:"version-v4/Constraints",title:"Constraints",description:"Constraints in the platform determine which values the data properties can have and which cannot. In general, a constraint is defined as a property which value should always be NULL.",source:"@site/versioned_docs/version-v4/Constraints.md",sourceDirName:".",slug:"/Constraints",permalink:"/v4/Constraints",draft:!1,editUrl:"https://github.com/lsfusion/platform/edit/v4/docs/en/Constraints.md",tags:[],version:"v4",lastUpdatedAt:1640850738,formattedLastUpdatedAt:"Dec 30, 2021",frontMatter:{title:"Constraints"},sidebar:"version-v4/learn",previous:{title:"Calculated events",permalink:"/v4/Calculated_events"},next:{title:"Simple constraints",permalink:"/v4/Simple_constraints"}},l={},c=[{value:"Show message",id:"message",level:3},{value:"Language",id:"language",level:3},{value:"Examples",id:"examples",level:3}],p={toc:c};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Constraints in the platform determine which values the ",(0,r.kt)("a",{parentName:"p",href:"/v4/Data_properties_DATA"},"data properties")," can have and which cannot. In general, a constraint is defined as a property which value should always be ",(0,r.kt)("inlineCode",{parentName:"p"},"NULL"),"."),(0,r.kt)("p",null,"In fact, a constraint is a ",(0,r.kt)("a",{parentName:"p",href:"/v4/Simple_event"},"simple event"),", where condition is the constrained property and handling is ",(0,r.kt)("a",{parentName:"p",href:"#message"},"showing")," all the non-",(0,r.kt)("inlineCode",{parentName:"p"},"NULL")," values (in the ",(0,r.kt)("a",{parentName:"p",href:"/v4/In_a_print_view_PRINT#interactive"},"asynchronous message")," mode) and ",(0,r.kt)("a",{parentName:"p",href:"/v4/Cancel_changes_CANCEL"},"canceling")," all the changes. As well as for a simple event, you need to specify a base ",(0,r.kt)("a",{parentName:"p",href:"/v4/Events"},"event"),", which determines when the defined constraint is checked. "),(0,r.kt)("p",null,"Compared to implementation via simple events, constraints have a set of additional advantages:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'There is a global checking procedure upon a working database for constraints (similarly to "recalculation" technique in simple events which is not applicable here as long as the handler contains the cancel changes operator)'),(0,r.kt)("li",{parentName:"ul"},"Constraints are more understandable and readable since, unlike simple events, they emphasize the static/declarative nature of these rules, i.e. their independence from the moment in time."),(0,r.kt)("li",{parentName:"ul"},"You can use the created constraint when showing dialogs for changing properties used in this constraint. In this case, an additional filter will be set in the dialog so that, when the property value changes to the selected one, the constraint is not violated.")),(0,r.kt)("p",null,"Note that in some cases, instead of showing a message to the user and canceling the transaction, it is necessary, for example, to automatically resolve the violated constraint. In that case, it is recommended to use ",(0,r.kt)("a",{parentName:"p",href:"/v4/Simple_constraints"},"simple constraints"),", or, if it is impossible, simple events."),(0,r.kt)("h3",{id:"message"},"Show message"),(0,r.kt)("p",null,"For any non-",(0,r.kt)("inlineCode",{parentName:"p"},"NULL")," value ",(0,r.kt)("a",{parentName:"p",href:"/v4/In_a_print_view_PRINT"},"output")," the platform uses an automatically generated ",(0,r.kt)("a",{parentName:"p",href:"/v4/Forms"},"form"),", consisting of:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"one ",(0,r.kt)("a",{parentName:"li",href:"/v4/Form_structure#objects"},"group of objects")," with the objects corresponding to the parameters of the constrained property."),(0,r.kt)("li",{parentName:"ul"},"properties with the matching classes belonging to the ",(0,r.kt)("inlineCode",{parentName:"li"},"System.recognize")," ",(0,r.kt)("a",{parentName:"li",href:"/v4/Groups_of_properties_and_actions"},"property group"),"."),(0,r.kt)("li",{parentName:"ul"},"a ",(0,r.kt)("a",{parentName:"li",href:"/v4/Form_structure#filters"},"filter")," equal to the constrained property."),(0,r.kt)("li",{parentName:"ul"},"a global message defined by the developer when creating the constraint.")),(0,r.kt)("h3",{id:"language"},"Language"),(0,r.kt)("p",null,"Constraints are created using the ",(0,r.kt)("a",{parentName:"p",href:"/v4/CONSTRAINT_statement"},(0,r.kt)("inlineCode",{parentName:"a"},"CONSTRAINT")," statement"),". "),(0,r.kt)("h3",{id:"examples"},"Examples"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-lsf"},"// balance not less than 0\nCONSTRAINT balance(Sku s, Stock st) < 0\n    MESSAGE 'The balance cannot be negative for ' + (GROUP CONCAT 'Product: ' + name(Sku ss) + ' Warehouse: ' + name(Stock sst), '\\n' IF SET(balance(ss, sst) < 0));\n\nbarcode = DATA STRING[15] (Sku);\n// \"emulation\" security policy\nCONSTRAINT DROPCHANGED(barcode(Sku s)) AND name(currentUser()) != 'admin' MESSAGE 'Only the administrator is allowed to change the barcode for an already created product';\n\nsku = DATA Sku (OrderDetail);\nin = DATA BOOLEAN (Sku, Customer);\n\nCONSTRAINT sku(OrderDetail d) AND NOT in(sku(d), customer(order(d)))\n    // a filter by available sku when selecting an item for an order line will be applied\n    CHECKED BY sku[OrderDetail] \n    MESSAGE 'In the order, a product unavailable to the user is selected for the selected customer';\n")))}u.isMDXComponent=!0}}]);